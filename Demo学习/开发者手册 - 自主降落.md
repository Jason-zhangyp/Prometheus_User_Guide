# 自主降落

本教程的目的：
- 理解二维码识别程序背后的原理
- 掌握降落板识别程序，并能够进行二次开发
- 理解追踪的原理，运动目标的状态估计的原理
- 掌握自主降落程序，并能够进行二次开发

## 识别算法介绍

**landpad_det.cpp** 
 - 真实环境中订阅的相机话题为`xxx`
 - 仿真环境中订阅的相机话题为`xxx`
 - 配置文件
 - 算法识别流程

降落板示例。。。。。。。

## 自主降落算法介绍
**autonomous_landing.cpp** 
- 订阅降落板识别检测结果，即相对位置
 	
		ros::Subscriber vision_sub = nh.subscribe<prometheus_msgs::DetectionInfo>("/prometheus/target", 10, vision_cb);
    
- 执行追踪算法及追踪策略（请阅读源码进行学习）
- 发布上层控制指令

		ros::Publisher command_pub = nh.advertise<prometheus_msgs::ControlCommand>("/prometheus/control_command", 10);

- 参数`Thres_vision`为视觉丢失阈值，参数`distance_thres`为判断是否直接上锁距离阈值，参数`landing_pad_height`为降落板高度，参数`use_ukf`表示是否使用UKF目标状态进行滤波估计，`moving_target`表示目标是静止或者移动，`kpx_land/kpy_land/kpz_land`为控制参数，`start_point_x/start_point_y/start_point_z`为起始点位置


## 仿真流程
- 运行启动脚本，注意修改参数配置文件`autonomous_landing.yaml`
    	roslaunch prometheus_gazebo sitl_landing.launch
- 若想控制小车移动，等Gazebo启动完成后，运行以下命令
		rosrun prometheus_gazebo move_landing_pad.py
- 启动后，输入1启动自动降落任务，飞机将起飞至起始点
	[![GD54l8.md.png](https://s1.ax1x.com/2020/04/05/GD54l8.md.png)](https://imgchr.com/i/GD54l8)
- 飞机将持续读取图像信息，结果可在终端查看，并可与真值进行比较。如丢失图像信息，飞机将会悬停在当前点
	[![GD5hSf.md.png](https://s1.ax1x.com/2020/04/05/GD5hSf.md.png)](https://imgchr.com/i/GD5hSf)
- 当飞机与降落板位置小于阈值时，飞机将自动上锁，完成任务
	[![GD52FI.md.png](https://s1.ax1x.com/2020/04/05/GD52FI.md.png)](https://imgchr.com/i/GD52FI)

[测试视频1](https://www.bilibili.com/video/av84249695/)
[测试视频1](https://www.bilibili.com/video/av84262462/)

## 如何进行真机实验？  

待补充  
